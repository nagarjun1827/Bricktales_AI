{
  "projects": {
    "description": "Stores project-level information.",
    "columns": {
      "project_id": "SERIAL PRIMARY KEY",
      "project_name": "TEXT NOT NULL",
      "project_code": "VARCHAR(50) UNIQUE",
      "client_name": "TEXT",
      "start_date": "DATE",
      "end_date": "DATE",
      "created_at": "TIMESTAMP WITH TIME ZONE DEFAULT NOW()"
    },
    "dependencies": {}
  },

  "locations": {
    "description": "Defines locations or sites under each project.",
    "columns": {
      "location_id": "SERIAL PRIMARY KEY",
      "project_id": "INT NOT NULL REFERENCES projects(project_id) ON DELETE CASCADE",
      "location_name": "TEXT NOT NULL",
      "address": "TEXT",
      "latitude": "DECIMAL(9,6)",
      "longitude": "DECIMAL(9,6)",
      "created_at": "TIMESTAMP WITH TIME ZONE DEFAULT NOW()"
    },
    "dependencies": {
      "project_id": "projects.project_id"
    }
  },

  "boq_files": {
    "description": "Metadata and CRUD control for uploaded BoQ files.",
    "columns": {
      "boq_id": "SERIAL PRIMARY KEY",
      "project_id": "INT NOT NULL REFERENCES projects(project_id) ON DELETE CASCADE",
      "file_name": "TEXT NOT NULL",
      "file_path": "TEXT",
      "file_type": "VARCHAR(20) DEFAULT 'xlsx'",
      "upload_timestamp": "TIMESTAMP WITH TIME ZONE DEFAULT NOW()",
      "uploaded_by": "TEXT",
      "version": "INT DEFAULT 1",
      "is_active": "BOOLEAN DEFAULT TRUE",
      "notes": "TEXT"
    },
    "dependencies": {
      "project_id": "projects.project_id"
    }
  },

  "boq_items": {
    "description": "Detailed BoQ line items extracted from files.",
    "columns": {
      "item_id": "SERIAL PRIMARY KEY",
      "boq_id": "INT NOT NULL REFERENCES boq_files(boq_id) ON DELETE CASCADE",
      "item_code": "VARCHAR(50)",
      "item_description": "TEXT NOT NULL",
      "unit_of_measurement": "VARCHAR(20) NOT NULL",
      "quantity": "DECIMAL(18,3) NOT NULL CHECK (quantity >= 0)",
      "supply_unit_rate": "DECIMAL(18,2) CHECK (supply_unit_rate >= 0)",
      "supply_amount": "DECIMAL(18,2) GENERATED ALWAYS AS (quantity * supply_unit_rate) STORED",
      "labour_unit_rate": "DECIMAL(18,2) CHECK (labour_unit_rate >= 0)",
      "labour_amount": "DECIMAL(18,2) GENERATED ALWAYS AS (quantity * labour_unit_rate) STORED",
      "total_amount": "DECIMAL(18,2) GENERATED ALWAYS AS (supply_amount + labour_amount) STORED",
      "location_id": "INT REFERENCES locations(location_id)",
      "created_at": "TIMESTAMP WITH TIME ZONE DEFAULT NOW()",
      "updated_at": "TIMESTAMP WITH TIME ZONE DEFAULT NOW()"
    },
    "dependencies": {
      "boq_id": "boq_files.boq_id",
      "location_id": "locations.location_id"
    }
  }
}
